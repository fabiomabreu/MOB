using System;
using System.Linq.Expressions;
using LinqKit;
using Target.Venda.DataAccess.Base;
using Target.Venda.Model.Entidade;
using Target.Venda.Model.Visao;

namespace Target.Venda.DataAccess.Entidade;

public class ParametroTelaDetalheDAL : EntidadeBaseDAL<ParametroTelaDetalheMO>
{
	protected override Expression<Func<ParametroTelaDetalheMO, bool>> GetWhere(Expression<Func<ParametroTelaDetalheMO, bool>> whereClause, ParametroTelaDetalheMO exemplo)
	{
		if (exemplo.SEQ > 0)
		{
			whereClause = whereClause.And((ParametroTelaDetalheMO x) => x.SEQ == exemplo.SEQ);
		}
		if (!string.IsNullOrEmpty(exemplo.CODIGO_TELA))
		{
			whereClause = whereClause.And((ParametroTelaDetalheMO x) => x.SEQ == exemplo.SEQ);
		}
		return whereClause;
	}

	public ConfiguracaoTelaVendaVO ObterParametroTelaVendas()
	{
		string select = "\r\n            SELECT \r\n            CAST(MAX([2]) AS BIT) AS  [EXIBIR_COLUNA_DE_DESCONTO_DOS_ITENS],\r\n            CAST(MAX([3]) AS BIT) AS  [EXIBIR_CONFIRMACAO_PARA_LANCAR_FALTA],\r\n            CAST(MAX([4]) AS BIT) AS  [ATUALIZA_COND_COMERCIAIS_DO_CLIENTE],\r\n            CAST(MAX([5]) AS BIT) AS  [EXIBIR_BOTAO_PARA_ACESSAR_ESTOQUE_POR_LOCAL],\r\n            CAST(MAX([6]) AS BIT) AS  [VER_DESCONTOS_DO_ITEM_SEPARADAMENTE],\r\n            CAST(MAX([7]) AS BIT) AS  [EXIBIR_PRECO_DO_PRODUTO_COM_DESC_PROM_APLICADO],\r\n            CAST(MAX([8]) AS BIT) AS  [PED_ELE_HABILITA_SELECAO_DO_LANCADOR],\r\n            CAST(MAX([9]) AS BIT) AS  [VENDEDOR_TMKT_COMO_PRINCIPAL_DO_PEDIDO],\r\n            CAST(MAX([10]) AS BIT) AS [VENDEDOR_DO_CLIENT_COMO_SECUND_DO_PEDIDO],\r\n            CAST(MAX([11]) AS BIT) AS [FATURA_NA_MAIOR_UNID_DE_VENDA_POSSIVEL],\r\n            CAST(MAX([12]) AS BIT) AS [PESO_LIQ_SUBSTITUI_PESO_BRT_NO_CALCULO_FRETE],\r\n            CAST(MAX([13]) AS BIT) AS [USAR_DESCONTO_GERAL_NO_CALCULO_DA_VERBA],\r\n            CAST(MAX([14]) AS BIT) AS [PERMITE_ALTERAR_DESCONTO_POR_QUANTIDADE],\r\n            CAST(MAX([15]) AS BIT) AS [AVISA_QUANDO_PRODUTO_POSSUI_DESC_POR_QTDE],\r\n            CAST(MAX([17]) AS BIT) AS [SUGERIR_TRANSPORTADORA_DO_CLIENTE],\r\n            CAST(MAX([18]) AS BIT) AS [CORTE_AUTO_PRODUTO_COM_RESTR_VENDA],\r\n            CAST(MAX([19]) AS BIT) AS [UTILIZA_BONIFICACAO_DE_ITENS],\r\n            CAST(MAX([21]) AS BIT) AS [NAO_CARREGA_VENDEDOR_NA_ABERTURA_DO_PEDV],\r\n            CAST(MAX([22]) AS BIT) AS [ABERTURA_AUTO_DE_TELA_PARA_INF_VOLUMES],\r\n            CAST(MAX([23]) AS BIT) AS [TAB_PRE_OCULTA_FABRIC_E_MOSTRA_DESC_PROM],\r\n            CAST(MAX([24]) AS BIT) AS [PED_BONIFICACAO_DEBITAR_VL_PEDIDO_DA_VERBA],\r\n            CAST(MAX([25]) AS BIT) AS [CONF_ITEM_BONIF_AO_LANCAR_FOCO_NO_SIM],\r\n            CAST(MAX([26]) AS BIT) AS [SUGERIR_TIPO_DE_PEDIDO_DO_CLIENTE],\r\n            CAST(MAX([27]) AS BIT) AS [SUGERIR_TABELA_DE_PRECOS_DO_CLIENTE],\r\n            CAST(MAX([28]) AS BIT) AS [SUGERIR_CONDICAO_DE_PAGTO_DO_CLIENTE],\r\n            CAST(MAX([29]) AS BIT) AS [SUGERIR_FORMA_DE_PAGAMENTO_DO_CLIENTE],\r\n            CAST(MAX([30]) AS BIT) AS [CALCULAR_CUSTO_FINANCEIRO_SOBRE_VALOR_DO_FRETE],\r\n            CAST(MAX([31]) AS BIT) AS [ATUALIZA_TRANSPORTADORA_DO_CLIENTE],\r\n            CAST(MAX([32]) AS BIT) AS [EXIBIR_AVISO_PARA_PRODUTO_NUNCA_COMPRADO],\r\n            CAST(MAX([33]) AS BIT) AS [DESC_QTDE_COMO_DESC_PERM_EM_BONIFICACOES],\r\n            CAST(MAX([34]) AS BIT) AS [CALCULA_AO_PASSAR_LIMITE_VENDEDOR],\r\n            CAST(MAX([35]) AS BIT) AS [TAB_PRE_OCULTA_UN_EST_E_MOSTRA_FATOR_CMP],\r\n            CAST(MAX([36]) AS BIT) AS [UTILIZA_TX_CUSTO_FIN_MENSAL_PRODUTOS],\r\n            CAST(MAX([37]) AS BIT) AS [BLOQUEIA_ALTERACAO_PRECOS_E_DESCONTOS],\r\n            CAST(MAX([38]) AS BIT) AS [TAB_PRE_BUSCA_PRECOS_E_DESC_NA_MONTAGEM],\r\n            CAST(MAX([39]) AS BIT) AS [VER_SIT_CLIENTE_QUANDO_PROD_EXIGE_DOC_ANVISA],\r\n            CAST(MAX([40]) AS BIT) AS [REFAZER_DESCONTOS_AO_TROCAR_COND_PAGAMENTO],\r\n            CAST(MAX([41]) AS BIT) AS [REFAZER_DESCONTOS_AO_TROCAR_TABELA_DE_PRECOS],\r\n            CAST(MAX([42]) AS BIT) AS [BUSCA_DESC_MAX_PERMITIDO],\r\n            CAST(MAX([44]) AS BIT) AS [CALCULAR_PRECO_DE_VENDA_NA_UNID_ESTOQUE],\r\n            CAST(MAX([45]) AS BIT) AS [ERRO_GERV_DESC_GERAL_APENAS_PARA_PGT_A_VISTA],\r\n            CAST(MAX([46]) AS BIT) AS [PED_DIGITACAO_OBRIGA_VEND_SECUNDARIO],\r\n            \r\n            CAST(MAX([48]) AS BIT) AS [LISTA_DE_ITENS_EXIBIR_COL_PRECO_FABRICA],\r\n            CAST(MAX([49]) AS BIT) AS [QUEBRA_VE_VS_RESPEITA_PERC_NO_TOTAL_NF],\r\n            CAST(MAX([50]) AS BIT) AS [EXIBIR_TELA_DE_PROM_FLEXIVEL_NO_LANCAMENTO_DE_PEDIDO],\r\n            \r\n            CAST(MAX([52]) AS BIT) AS [BUSCAR_PRODUTO_PELA_DESCRICAO_INICIAL],\r\n            CAST(MAX([53]) AS BIT) AS [DESC_COND_PAGTO_UTILIZAR_DESCONTO_AUTOMATICO],\r\n            \r\n            CAST(MAX([55]) AS BIT) AS [EXIBIR_SOMENTE_PRODUTOS_ASSOCIADOS_AO_CLIENTE],\r\n            CAST(MAX([56]) AS BIT) AS [VL_EXIBIR_OPCOES_DE_PAGTO_CONSIDERANDO_DESC_GRADES],\r\n            CAST(MAX([57]) AS BIT) AS [CONF_PRODUTO_QUE_NAO_CONSTA_NA_PROM_FLEX_FOCO_NO_NAO],\r\n            CAST(MAX([58]) AS BIT) AS [EXIBIR_COLUNA_SIGLA_FABRIC_NA_TABELA_DE_ITENS],\r\n            CAST(MAX([59]) AS BIT) AS [PED_BONIFICACAO_DESCONSIDERA_DESC_PERMITIDOS],\r\n            CAST(MAX([60]) AS BIT) AS [CONFIRMACAO_DA_COTACAO_FOCO_NO_NAO],\r\n            CAST(MAX([61]) AS BIT) AS [BLOQUEIA_VENDA_DE_PRODUTO_EM_MAIS_DE_UMA_PROMOCAO],\r\n            CAST(MAX([62]) AS BIT) AS [BUSCA_VALORES_PADROES_NO_CANCELAMENTO],\r\n            CAST(MAX([63]) AS BIT) AS [PERMITE_INCLUIR_O_PRODUTO_APENAS_UMA_VEZ_EXCETO_BONIF],\r\n            CAST(MAX([64]) AS BIT) AS [BUSCAR_PRODUTO_POR_TODAS_AS_DESCRICOES],\r\n            CAST(MAX([65]) AS BIT) AS [APOS_DIGITACAO_QTDE_PREPARA_CURSOR_LANC_DE_NOVO_ITEM],\r\n            CAST(MAX([66]) AS BIT) AS [CALCULA_VERBA_PARA_ITENS_COMPONENTES_DE_PROMOCAO],\r\n            CAST(MAX([67]) AS BIT) AS [ELIMINAR_ATALHO_DO_BOTAO_EFETIVA],\r\n            CAST(MAX([68]) AS BIT) AS [BLOQUEIA_ALTERACAO_DESCONTO_1],\r\n            CAST(MAX([69]) AS BIT) AS [BLOQUEIA_ALTERACAO_DESCONTO_2],\r\n            CAST(MAX([70]) AS BIT) AS [BLOQUEIA_ALTERACAO_PRECOS],\r\n            CAST(MAX([71]) AS BIT) AS [VL_CALCULA_VALOR_TOTAL_EM_UNIDADES_DE_VENDA],\r\n            CAST(MAX([72]) AS BIT) AS [REGISTRA_DADOS_DE_CONSULTA_AO_PRODUTO],\r\n            CAST(MAX([73]) AS BIT) AS [VL_UTILIZA_PRECO_CHEIO_NF_E_DESC_BOL_POR_ITEM],\r\n            CAST(MAX([74]) AS BIT) AS [INICIA_CURSOR_NO_COD_DO_PRODUTO_LANCA_PEDIDO__PDV],\r\n            CAST(MAX([75]) AS BIT) AS [PEDIDO_ASSUME_EMPRESA_DO_CADASTRO_DO_VENDEDOR],\r\n            CAST(MAX([76]) AS BIT) AS [ABERTURA_AUTO_TELA_VOLUMES_NA_EFETIVACAO_DO_PEDIDO],\r\n            CAST(MAX([77]) AS BIT) AS [EXIBIR_COLUNA_DATA_DE_VALIDADE],\r\n            CAST(MAX([78]) AS BIT) AS [EXIBIR_AVISO_QUANDO_O_DESCONTO_FOR_EXTRAPOLADO],\r\n            CAST(MAX([79]) AS BIT) AS [PRECO_UNITARIO_BASEADO_NA_UNID_FORMADORA_DE_PRECO],\r\n            CAST(MAX([80]) AS BIT) AS [ESTOQUE_EXIBIR_QUANTIDADE_ESTOQUE_C],\r\n            CAST(MAX([81]) AS BIT) AS [PERMITE_FATURAR_COM_O_CADASTRO_DO_CLIENTE_INCOMPLETO],\r\n            CAST(MAX([82]) AS BIT) AS [EXIBIR_PESO_BRUTO_TOTAL_DO_ITEM],\r\n            CAST(MAX([83]) AS BIT) AS [EXIBIR_PESO_LIQUIDO_TOTAL_DO_ITEM],\r\n            CAST(MAX([84]) AS BIT) AS [BUSCAR_PRODUTO_PELA_DESCRICAO_RESUMIDA],\r\n            CAST(MAX([85]) AS BIT) AS [ASSOCIA_TROCA_SOMENTE_AO_MESMO_VENDEDOR_E_CLIENTE],\r\n            CAST(MAX([86]) AS BIT) AS [EXIBIR_QUANTIDADE_CONFERENCIA_PENDENTE],\r\n            CAST(MAX([88]) AS BIT) AS [LANCAMENTO_DO_PEDIDO_PERMITE_SELECIONAR_EMPRESA],\r\n            CAST(MAX([89]) AS BIT) AS [LIB_AUTO_MOSTRAR_MENSAGEM_DE_ALERTA_DO_CLIENTE],\r\n            CAST(MAX([90]) AS BIT) AS [CORTE_AUTO_INSUF_ESTOQUE_EXIBIR_CONFIRMACAO],\r\n            CAST(MAX([92]) AS BIT) AS [LANCA_ITEM_PELO_CODIGO_ESPECIFICO_DO_CLIENTE],\r\n            CAST(MAX([93]) AS BIT) AS [NA_EFETIVACAO_SUGERE_ENVIO_DA_COTACAO_VIA_E_MAIL],\r\n            CAST(MAX([94]) AS BIT) AS [OBRIGA_INFORMACAO_DA_DATA_DE_ENTREGA_DO_PEDIDO],\r\n            CAST(MAX([95]) AS BIT) AS [CALCULA_DESCONTO_FINANCEIRO_AUTOMATICO],\r\n            CAST(MAX([96]) AS BIT) AS [AGRUPAR_DESC_PERM_E_DESC_POR_QTDE_NO_DESC_1],\r\n            CAST(MAX([97]) AS BIT) AS [TELA_PARA_VISUALIZAR_DESCONTOS_SEPARADAMENTE],\r\n            CAST(MAX([98]) AS BIT) AS [UTILIZA_DESCONTO_SUFRAMA_AUTOMATICO_POR_TIPO_DE_PEDIDO],\r\n            CAST(MAX([99]) AS BIT) AS [CORTE_AUTO_INSUF_ESTOQUE_NAO_LIBERA_PEDIDO],\r\n            CAST(MAX([100]) AS BIT) AS [EXIBIR_COLUNA_PERC_MG_BRUTA_REPOSICAO],\r\n            CAST(MAX([101]) AS BIT) AS [EXIBIR_COLUNA_PERC_MG_BRUTA_ULT_ENTR],\r\n            CAST(MAX([102]) AS BIT) AS [EXIBIR_COLUNA_PERC_MG_BRUTA_MED_POND],\r\n            CAST(MAX([103]) AS BIT) AS [EXIBIR_COLUNA_VALOR_MG_BRUTA_REPOSICAO],\r\n            CAST(MAX([104]) AS BIT) AS [EXIBIR_COLUNA_VALOR_MG_BRUTA_ULT_ENTR],\r\n            CAST(MAX([105]) AS BIT) AS [EXIBIR_COLUNA_VALOR_MG_BRUTA_MED_POND],\r\n            CAST(MAX([106]) AS BIT) AS [COBRA_FRETE_QUANDO_FOR_ENTREGA],\r\n            CAST(MAX([107]) AS BIT) AS [ESCOLHA_AUTOMATICA_SE_CIF_OU_FOB_TRANSPORTADORA],\r\n            CAST(MAX([108]) AS BIT) AS [TODAS_DESCRICOES_EXIBIR_DESCRICAO_COMPLETA],\r\n            CAST(MAX([109]) AS BIT) AS [CANC_PEDIDO_VALOR_MENOR_QUE_O_MINIMO_DA_COND_PGTO],\r\n            CAST(MAX([110]) AS BIT) AS [SOMA_NO_VALOR_TOTAL_DO_PRODUTO],\r\n            CAST(MAX([111]) AS BIT) AS [EXIBIR_COLUNAS_DE_VALOR_ST_E_ST_TOTAL],\r\n            CAST(MAX([112]) AS BIT) AS [EXCLUI_PROMOCAO_INTEIRA_AO_DESCARACTERIZAR],\r\n            CAST(MAX([113]) AS BIT) AS [MANTER_DESCONTO_APLICADO_1_E_2_NOS_PEDIDOS_ELETRONICOS],\r\n            CAST(MAX([114]) AS BIT) AS [BUSCA_AVANCADA_DE_DESCRICAO_DE_PRODUTOS],\r\n            CAST(MAX([116]) AS BIT) AS [CANC_PEDIDO_VALOR_MENOR_QUE_O_MINIMO_DA_COND_PGTO_PELO_VALOR_NF],\r\n            CAST(MAX(ISNULL([133], 0) ) AS BIT) AS [PED_ELE_UTILIZA_API_IMPOSTO]\r\n\r\n            FROM pcfg_tela_det C\r\n            PIVOT\r\n            (\r\n                MAX(ATIVO)\r\n                FOR SEQ IN (\r\n\t            [2],\r\n\t            [3] ,\r\n\t            [4] ,\r\n\t            [5] ,\r\n\t            [6] ,\r\n\t            [7] ,\r\n\t            [8] ,\r\n\t            [9] ,\r\n\t            [10],\r\n\t            [11],\r\n\t            [12],\r\n\t            [13],\r\n\t            [14],\r\n\t            [15],\r\n\t            [17],\r\n\t            [18],\r\n\t            [19],\r\n\t            [21],\r\n\t            [22],\r\n\t            [23],\r\n\t            [24],\r\n\t            [25],\r\n\t            [26],\r\n\t            [27],\r\n\t            [28],\r\n\t            [29],\r\n\t            [30],\r\n\t            [31],\r\n\t            [32],\r\n\t            [33],\r\n\t            [34],\r\n\t            [35],\r\n\t            [36],\r\n\t            [37],\r\n\t            [38],\r\n\t            [39],\r\n\t            [40],\r\n\t            [41],\r\n\t            [42],\r\n\t            [44],\r\n\t            [45],\r\n\t            [46],\r\n\t            \r\n\t            [48],\r\n\t            [49],\r\n\t            [50],\r\n\t            \r\n\t            [52],\r\n\t            [53],\r\n\t            \r\n\t            [55],\r\n\t            [56],\r\n\t            [57],\r\n\t            [58],\r\n\t            [59],\r\n\t            [60],\r\n\t            [61],\r\n\t            [62],\r\n\t            [63],\r\n\t            [64],\r\n\t            [65],\r\n\t            [66],\r\n\t            [67],\r\n\t            [68],\r\n\t            [69],\r\n\t            [70],\r\n\t            [71],\r\n\t            [72],\r\n\t            [73],\r\n\t            [74],\r\n\t            [75],\r\n\t            [76],\r\n\t            [77],\r\n\t            [78],\r\n\t            [79],\r\n\t            [80],\r\n\t            [81],\r\n\t            [82],\r\n\t            [83],\r\n\t            [84],\r\n\t            [85],\r\n\t            [86],\r\n\t            [88],\r\n\t            [89],\r\n\t            [90],\r\n\t            [92],\r\n\t            [93],\r\n\t            [94],\r\n\t            [95],\r\n\t            [96],\r\n\t            [97],\r\n\t            [98],\r\n\t            [99],\r\n\t            [100],\r\n\t            [101],\r\n\t            [102],\r\n\t            [103],\r\n\t            [104],\r\n\t            [105],\r\n\t            [106],\r\n\t            [107],\r\n\t            [108],\r\n\t            [109],\r\n\t            [110],\r\n\t            [111],\r\n\t            [112],\r\n\t            [113],\r\n\t            [114],\r\n                [116],\r\n                [133]) \r\n            ) AS P\r\n            WHERE cd_tela = 'VENDAS'\r\n\r\n           ";
		return ExecutarScalarSQL<ConfiguracaoTelaVendaVO>(select, Array.Empty<object>());
	}

	public ConfiguracaoTelaClienteVO ObterParametroTelaCliente()
	{
		string select = "\r\n            SELECT \r\n            CAST(MAX([13]) AS BIT) AS  [ATUALIZA_AUTO_ASSOC_CLIENTE_X_COND_DE_PAGTO],\r\n            CAST(MAX([19]) AS BIT) AS  [OBRIGA_CADASTRO_DOS_DOCUMENTOS_DE_SEGMENTO_DO_CLIENTE]\r\n\r\n            FROM pcfg_tela_det C\r\n            PIVOT\r\n            (\r\n                MAX(ATIVO)\r\n                FOR SEQ IN (\r\n\t            [13],\r\n\t            [19] ) \r\n            ) AS P\r\n            WHERE cd_tela = 'CLIENTE'\r\n\r\n           ";
		return ExecutarScalarSQL<ConfiguracaoTelaClienteVO>(select, Array.Empty<object>());
	}

	public ConfiguracaoTelaEmissaoNotaVO ObterParametroTelaEmissaoNota()
	{
		string select = " SELECT \r\n            CAST(MAX([66]) AS BIT) AS  [SOMA_FRETE_TIPO_CIF_NO_VALOR_DA_NOTA],\r\n            CAST(MAX([67]) AS BIT) AS  [SOMA_FRETE_TIPO_FOB_NO_VALOR_DA_NOTA]\r\n\r\n            FROM pcfg_tela_det C\r\n            PIVOT\r\n            (\r\n                MAX(ATIVO)\r\n                FOR SEQ IN (\r\n\t            [66],\r\n\t            [67] ) \r\n            ) AS P\r\n            WHERE cd_tela = 'EMIS_NF'";
		return ExecutarScalarSQL<ConfiguracaoTelaEmissaoNotaVO>(select, Array.Empty<object>());
	}

	public ConfiguracaoTelaTransferenciaEstoqueVO ObterParametroTelaTransferenciaEstoque()
	{
		string select = " SELECT  CAST(MAX([1]) AS BIT) AS  [REALIZA_TRANSFERENCIA_APOS_FATURAMENTO],\r\n                                    CAST(MAX([2]) AS BIT) AS  [PERMITE_TRANSF_ESPECIAL_PARA_VENDAS_NORMAIS_E_VICE_VERSA],\r\n                                    CAST(MAX([3]) AS BIT) AS  [MANTEM_PRODUTOS_COM_A_UNIDADE_DIGITADA_NO_PEDIDO_DE_VENDA]\r\n\r\n                                    FROM pcfg_tela_det C\r\n                                    PIVOT\r\n                                    (\r\n                                        MAX(ATIVO)\r\n                                        FOR SEQ IN (\r\n\t                                    [1],\r\n                                        [2],\r\n\t                                    [3] ) \r\n                                    ) AS P\r\n                                    WHERE cd_tela = 'TRANSF_EST'";
		return ExecutarScalarSQL<ConfiguracaoTelaTransferenciaEstoqueVO>(select, Array.Empty<object>());
	}
}
