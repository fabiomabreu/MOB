using System;
using System.Linq.Expressions;
using LinqKit;
using Target.Venda.DataAccess.Base;
using Target.Venda.Helpers.Log;
using Target.Venda.Model.Entidade;
using Target.Venda.Model.Visao;

namespace Target.Venda.DataAccess.Entidade;

public class TipoPedidoDAL : EntidadeBaseDAL<TipoPedidoMO>
{
	protected override Expression<Func<TipoPedidoMO, bool>> GetWhere(Expression<Func<TipoPedidoMO, bool>> whereClause, TipoPedidoMO exemplo)
	{
		if (string.IsNullOrEmpty(exemplo.TIPO_PEDIDO))
		{
			whereClause = whereClause.And((TipoPedidoMO x) => x.TIPO_PEDIDO == exemplo.TIPO_PEDIDO);
		}
		return whereClause;
	}

	public TipoPedidoVO ObterTipoPedidoPeloCodigo(string codigoTipoPedido)
	{
		try
		{
			string select = "  \r\n                       SELECT   tp_ped\t    AS\tCODIGO_TIPO_PEDIDO,\r\n                                descricao\tAS\tDESCRICAO,\r\n                                CAST(ISNULL(atualiza_estoque,0) AS BIT)\tAS\tATUALIZA_ESTOQUE,\r\n                                CAST(ISNULL(gera_titrec,0) AS BIT)\tAS\tGERA_TITULO_RECEBER,\r\n                                CAST(ISNULL(imprime_nf,0) AS BIT)\tAS\tIMPRIME_NOTA_FISCAL,\r\n                                CAST(ISNULL(calcula_icm,0) AS BIT)\tAS\tCALCULA_ICMS,\r\n                                CAST(ISNULL(calcula_ipi,0) AS BIT)\tAS\tCALCULA_IPI,\r\n                                CAST(ISNULL(estat_com,0) AS BIT)\tAS\tESTATISTICA_COMERCIAL,\r\n                                CAST(ISNULL(principal,0) AS BIT)\tAS\tPRINCIPAL,\r\n                                CAST(ISNULL(transf_estoque,0) AS BIT)\tAS\tTRANSFERENCIA_ESTOQUE,\r\n                                cd_emp_transf   AS\tCODIGO_EMPRESA_TRANSFERENCIA,\r\n                                cd_local_transf AS\tCODIGO_LOCAL_TRANSFERENCIA,\r\n                                CAST(ISNULL(calcula_icm_ipi,0) AS BIT)\tAS\tCALCULA_ICMS_IPI,\r\n                                CAST(ISNULL(automat_3_casa,0) AS BIT)\tAS\tAUTOMATICO_3_CASA,\r\n                                CAST(ISNULL(ipi_base_calc_icm,0) AS BIT)\tAS\tIPI_BASE_CALCULO_ICMS,\r\n                                CAST(ISNULL(consignacao,0) AS BIT)\tAS\tCONSIGNACAO,\r\n                                CAST(ISNULL(vda_posconsig,0) AS BIT)\tAS\tVENDA_POS_CONSIGUINACAO,\r\n                                CAST(ISNULL(dev_fornecedor,0) AS BIT)\tAS\tDEVOLUCAO_FORNECEDOR,\r\n                                CAST(ISNULL(vda_especial,0) AS BIT)\tAS\tVENDA_ESPECIAL,\r\n                                CAST(ISNULL(ativo,0) AS BIT)\tAS\tATIVO,\r\n                                CAST(ISNULL(icms_diferido,0) AS BIT)\tAS\tICMS_DIFERIDO,\r\n                                CAST(ISNULL(comissao,0) AS BIT)\tAS\tCOMISSAO,\r\n                                tp_ped_sr   AS\tTIPO_PEDIDO_SR,\r\n                                CAST(ISNULL(vs_principal,0) AS BIT)\tAS\tVS_PRINCIPAL,\r\n                                CAST(ISNULL(curva_abc,0) AS BIT)\tAS\tCURVA_ABC,\r\n                                CAST(ISNULL(automatico,0) AS BIT)\tAS\tAUTOMATICO,\r\n                                tp_ped_edi\tAS\tTIPO_PEDIDO_EDI,\r\n                                CAST(ISNULL(armazenagem,0) AS BIT)\tAS\tARMAZENAGEM,\r\n                                CAST(ISNULL(mail_cliente,0) AS BIT)\tAS\tMAIL_CLIENTE,\r\n                                CAST(ISNULL(mail_vendedor,0) AS BIT)\tAS\tMAIL_VENDEDOR,\r\n                                CAST(ISNULL(tp_ped_palm,0) AS BIT)\tAS\tTIPO_PEDIDO_PALM,\r\n                                CAST(ISNULL(bonificacao,0) AS BIT)\tAS\tBONIFICACAO,\r\n                                CAST(ISNULL(gera_meia_nota,0) AS BIT)\tAS\tGERA_MEIA_NOTA,\r\n                                tp_ped_meia_nota\tAS\tTIPO_PEDIDO_MEIA_NOTA,\r\n                                perc_nota\tAS\tPERCENTUAL_NOTA,\r\n                                formpgto_meia_nota\tAS\tFORMA_PAGAMENTO_MEIA_NOTA,\r\n                                CAST(ISNULL(utiliza_preco_custo,0) AS BIT)\tAS\tUTILIZA_PRECO_CUSTO,\r\n                                utiliza_preco_tp_custo\tAS\tUTILIZA_PRECO_TIPO_CUSTO,\r\n                                destaque_pedido\tAS\tDESTAQUE_PEDIDO,\r\n                                CAST(ISNULL(lote_manual,0) AS BIT)\tAS\tLOTE_MANUAL,\r\n                                CAST(ISNULL(prod_controlado,0) AS BIT)\tAS\tPRODUTO_CONTROLADO,\r\n                                baixa_lote\tAS\tBAIXA_LOTE,\r\n                                CAST(ISNULL(vda_med_dia,0) AS BIT)\tAS\tVENDA_MEDIA_DIA,\r\n                                CAST(ISNULL(busca_cfop_excecao,0) AS BIT)\tAS\tBUSCA_CFOP_EXCECAO,\r\n                                CAST(ISNULL(gera_verba,0) AS BIT)\tAS\tGERA_VERBA,\r\n                                CAST(ISNULL(restr_vda,0) AS BIT)\tAS\tRESTRICAO_VENDA,\r\n                                CAST(ISNULL(frete_base_calc_icm,0) AS BIT)\tAS\tFRETE_BASE_CALCULO_ICMS,\r\n                                CAST(ISNULL(quebra_it_bonif,0) AS BIT)\tAS\tQUEBRA_ITEM_BONIFICADO,\r\n                                tp_ped_bonif    AS\tTIPO_PEDIDO_BONIFICACAO,\r\n                                CAST(ISNULL(nf_item_preco_cheio,0) AS BIT)\tAS\tNOTA_FISCAL_ITEM_PRECO_CHEIO,\r\n                                CAST(ISNULL(imprime_orcamento,0) AS BIT)\tAS\tIMPRIME_ORCAMENTO,\r\n                                CAST(ISNULL(calcula_icm_subst,0) AS BIT)\tAS\tCALCULA_ICMS_SUBSTITUTO,\r\n                                CAST(ISNULL(imp_aliq_icm_itens,0) AS BIT)\tAS\tIMP_ALIQUOTA_ICMS_ITENS,\r\n                                CAST(ISNULL(calcula_icm_ressarc,0) AS BIT)\tAS\tCALCULA_ICMS_RESSARCIMENTO,\r\n                                CAST(ISNULL(atualiza_estoque_ctb,0) AS BIT)\tAS\tATUALIZA_ESTOQUE_CTB,\r\n                                CAST(ISNULL(imp_aliq_icm_isentos,0) AS BIT)\tAS\tIMP_ALIQUOTA_ICMS_ISENTOS,\r\n                                CAST(ISNULL(nao_calc_subst_titrec,0) AS BIT)\tAS\tNAO_CALCULA_SUBSTITUICAO_TITULO_RECEBER,\r\n                                tp_quebra_meia_nf\tAS\tTIPO_QUEBRA_MEIA_NOTA_FISCAL,\r\n                                CAST(ISNULL(utiliza_preco_tp_custo_sem_icm,0) AS BIT)\tAS\tUTILIZA_PRECO_TIPO_CUSTO_SEM_ICMS,\r\n                                mail_cliente_cod_mod\tAS\tMAIL_CLIENTE_CODIGO_MOD,\r\n                                CAST(ISNULL(calcula_icm_ressarc_bonif,0) AS BIT)\tAS\tCALCULA_ICMS_RESSARCIMENTO_BONIFICACAO,\r\n                                CAST(ISNULL(icm_ressarc_soma_nf,0) AS BIT)\tAS\tICMS_RESSARCIMENTO_SOMA_NOTA_FISCAL,\r\n                                CAST(ISNULL(icm_ressarc_soma_titrec,0) AS BIT)\tAS\tICMS_RESSARCIMENTO_SOMA_TITULO_RECEBIMENTO,\r\n                                CAST(ISNULL(pedido_pf_x_pj,0) AS BIT)\tAS\tPEDIDO_PF_X_PJ,\r\n                                CAST(ISNULL(venda_balcao,0) AS BIT)\tAS\tVENDA_BALCAO,\r\n                                CAST(ISNULL(somente_etapa_fatu,0) AS BIT)\tAS\tSOMENTE_ETAPA_FATURAMENTO,\r\n                                CAST(ISNULL(outros_locais_est,0) AS BIT)\tAS\tOUTROS_LOCAIS_ESTOQUE,\r\n                                CAST(ISNULL(selec_lote_todos_itens,0) AS BIT)\tAS\tSELECIONA_LOTE_TODOS_ITENS,\r\n                                CAST(ISNULL(utiliza_preco_custo_bonif,0) AS BIT)\tAS\tUTILIZA_PRECO_CUSTO_BONIFICADO,\r\n                                utiliza_preco_tp_custo_bonif\tAS\tUTILIZA_PRECO_TP_CUSTO_BONIF,\r\n                                tp_ped_it_bonif\tAS\tTIPO_PEDIDO_IT_BONIFICADO,\r\n                                CAST(ISNULL(suframa,0) AS BIT)\tAS\tSUFRAMA,\r\n                                CAST(ISNULL(utiliza_sit_trib_esp,0) AS BIT)\tAS\tUTILIZA_SITUACAO_TRIBUTACAO_ESP,\r\n                                CAST(ISNULL(servico,0) AS BIT)\tAS\tSERVICO,\r\n                                CAST(ISNULL(inventario,0) AS BIT)\tAS\tINVENTARIO,\r\n                                invent_tp_mov\tAS\tINVENTARIO_TIPO_MOVIMENTACAO,\r\n                                CAST(ISNULL(servico_tecnico_vend_princ,0) AS BIT)\tAS\tSERVICO_TECNICO_VENDA_PRINCIPAL,\r\n                                CAST(ISNULL(transf_outros_locais_est,0) AS BIT)\tAS\tTRANSFERENCIA_OUTROS_LOCAIS_ESTOQUE,\r\n                                CAST(ISNULL(elimina_filas_gerenciais,0) AS BIT)\tAS\tELIMINA_FILAS_GERENCIAIS,\r\n                                CAST(ISNULL(calc_ipi_frete,0) AS BIT)\tAS\tCALCULO_IPI_FRETE,\r\n                                CAST(ISNULL(somente_etapa_fatu_gera_expe,0) AS BIT)\tAS\tSOMENTE_ETAPA_FATURAMENTO_GERA_EXPEDICAO,\r\n                                CAST(ISNULL(destaque_st_totais_nf,0) AS BIT)\tAS\tDESTAQUE_ST_TOTAIS_NF,\r\n                                CAST(ISNULL(destaque_st_dados_adic,0) AS BIT)\tAS\tDESTAQUE_ST_DADOS_ADICIONAIS,\r\n                                CAST(ISNULL(destaque_ipi_totais_nf,0) AS BIT)\tAS\tDESTAQUE_IPI_TOTAIS_NF,\r\n                                CAST(ISNULL(destaque_ipi_dados_adic,0) AS BIT)\tAS\tDESTAQUE_IPI_DADOS_ADIC,\r\n                                CAST(ISNULL(utiliza_preco_custo_sem_st,0) AS BIT)\tAS\tUTILIZA_PRECO_CUSTO_SEM_ST,\r\n                                CAST(ISNULL(gera_nf_compra_autom,0) AS BIT)\tAS\tGERA_NF_COMPRA_AUTOMATICA,\r\n                                CAST(ISNULL(pedido_nf_entrada,0) AS BIT)\tAS\tPEDIDO_NF_ENTRADA,\r\n                                CAST(ISNULL(destaque_icm_item_st_totais_nf,0) AS BIT)\tAS\tDESTAQUE_ICMS_ITEM_ST_TOTAIS_NF,\r\n                                CAST(ISNULL(destaque_icm_item_st_dados_adic,0) AS BIT)\tAS\tDESTAQUE_ICMS_ITEM_ST_DADOS_ADICIONAIS,\r\n                                CAST(ISNULL(ressarc_industria,0) AS BIT)\tAS\tRESSARCIMENTO_INDUSTRIA,\r\n                                outros_locais_est_falta_cd_emp\tAS\tOUTROS_LOCAIS_ESTOQUE_FALTA_CD_EMP,\r\n                                outros_locais_est_falta_cd_local AS\tOUTROS_LOCAIS_ESTOQUE_FALTA_CD_LOCAL,\r\n                                CAST(ISNULL(verifica_limite_venda,0) AS BIT)\tAS\tVERIFICA_LIMITE_VENDA,\r\n                                tp_vl_custo_transf_auto\tAS\tTIPO_VALOR_CUSTO_TRANSFERENCIA_AUTO,\r\n                                CAST(ISNULL(prod_bonif_valor_zerado,0) AS BIT)\tAS\tPRODUTO_BONIFICADO_VALOR_ZERADO,\r\n                                CAST(ISNULL(prod_bonif_cst_espec,0) AS BIT)\tAS\tPRODUTO_BONIFICADO_CST_ESPEC,\r\n                              \r\n                                CAST(ISNULL(st_aliq_dif,0) AS BIT)\tAS\tST_ALIQUOTA_DIF,\r\n                                CAST(ISNULL(isenta_pis_cofins,0) AS BIT)\tAS\tISENTA_PIS_COFINS,\r\n                                cst_especifica_pis_cofins   AS\tCST_ESPECIFICA_PIS_COFINS,\r\n                                TpEntradaTransfAuto\tAS\tTIPO_ENTRADA_TRANSFERENCIA_AUTO,\r\n                                CAST(ISNULL(UtilizaTribEstDest,0) AS BIT)\tAS\tUTILIZA_TRIBUTACAO_ESTOQUE_DESTINO,\r\n                                CAST(ISNULL(UtilizaRecopi,0) AS BIT)\tAS\tUTILIZA_RECOPI,\r\n                                CAST(ISNULL(DescGerAutoCli,0) AS BIT)\tAS\tDESC_GERAL_AUTOMATICO_CLIENTE,\r\n                                CAST(ISNULL(ipi_base_calc_pis_cofins,0) AS BIT)\tAS\tIPI_BASE_CALCULO_PIS_COFINS,\r\n                                CAST(ISNULL(EnvioPdv,0) AS BIT)\tAS\tENVIO_PDV,\r\n                                CAST(ISNULL(PermiteAltLogistica,0) AS BIT)\tAS\tPERMITE_ALTERACAO_LOGISTICA,\r\n                                CAST(ISNULL(PedidoNFEntradaDevCliente,0) AS BIT)\tAS\tPEDIDO_NF_ENTRADA_DEVOLUCAO_CLIENTE,\r\n                                CAST(ISNULL(ConsumidorFinal,0) AS BIT) CONSUMIDOR_FINAL,\r\n                                CAST(ISNULL(EscolhaLoteAuto,0) AS BIT) ESCOLHA_LOTE_AUTOMATICO,\r\n\t\t\t\t\t\t\t\tCAST(ISNULL(IgnorarValidacaoValorMinPedido, 0) as BIT) IGNORAR_VALIDACAO_VALOR_MIN_PEDIDO,\r\n                                CAST(CASE\r\n                                        WHEN ( ISNULL( TipoNFConsumidorFinal, '' ) = 'NFCE' AND  ISNULL( IdentificaDestinatarioNFCe, 0 ) = 0 AND  ISNULL( InformaCpfCnpjNFCe, 0 ) = 0 ) \r\n                                            THEN 1\r\n                                            ELSE 0\r\n                                     END AS BIT) NFCE_SEM_IDENTIFICACAO_DESTINATARIO\r\n                       FROM tp_ped\r\n                       WHERE tp_ped = {0} ";
			return ExecutarScalarSQL<TipoPedidoVO>(select, new object[1] { codigoTipoPedido });
		}
		catch (Exception ex)
		{
			LogHelper.ErroLog(ex);
			throw ex;
		}
	}
}
